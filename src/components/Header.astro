---
import Logo from "./logo.astro";
import SharpRightArrowIcon from "./SharpRightArrowIcon.astro";
import MenuIcon from "./MenuIcon.astro";
import CloseIcon from "./CloseIcon.astro";
---

<header class="fixed top-0 left-0 w-full bg-transparent z-[60] p-10">
  <nav class="flex items-start justify-between">
    <Logo />

    <!-- Desktop nav -->
    <div
      class="hidden lg:flex items-center gap-8 text-sm uppercase tracking-wide"
    >
      <a
        href="/about"
        class="text-black no-underline hover:opacity-80 transition-opacity"
        >About</a
      >
      <a
        href="/handbook"
        class="text-black no-underline hover:opacity-80 transition-opacity"
        >Handbook</a
      >
      <a
        href="/opinion"
        class="text-black no-underline hover:opacity-80 transition-opacity"
        >Opinion</a
      >
    </div>

    <!-- Mobile toggle button -->
    <button
      id="openMobileNav"
      class="lg:hidden inline-flex items-center justify-center pr-3"
      aria-controls="mobileNav"
      aria-expanded="false"
    >
      <MenuIcon class="w-6 h-6" />
      <span class="sr-only">Open navigation menu</span>
    </button>
  </nav>

  <!-- Mobile full-screen nav -->
  <div
    id="mobileNav"
    class="hidden fixed inset-0 z-[70] bg-[#f5f5f5] p-10 overflow-y-auto"
    role="dialog"
    aria-modal="true"
  >
    <div class="flex justify-between items-start mb-10">
      <Logo />
      <button
        id="closeMobileNav"
        class="inline-flex items-center justify-center pr-3"
        aria-label="Close menu"
      >
        <CloseIcon class="w-6 h-6" />
        <span class="sr-only">Close navigation menu</span>
      </button>
    </div>

    <div class="flex flex-col gap-8">
      <a
        href="/about"
        class="flex justify-between items-center pb-5 border-b border-[#ccc] no-underline text-black hover:opacity-80 transition-opacity"
      >
        <span class="text-[32px] lg:text-[48px] font-light">About</span>
        <SharpRightArrowIcon class="w-12 h-12 lg:w-16 lg:h-16" />
      </a>
      <div
        class="flex justify-between items-center pb-5 border-b border-[#ccc]"
      >
        <span class="text-[32px] lg:text-[48px] font-light"
          >Frontend Handbook</span
        >
        <span class="text-[48px] lg:text-[72px] font-light">WIP</span>
      </div>
      <div
        class="flex justify-between items-center pb-5 border-b border-[#ccc]"
      >
        <span class="text-[32px] lg:text-[48px] font-light">Opinion</span>
        <span class="text-[48px] lg:text-[72px] font-light">WIP</span>
      </div>
    </div>
  </div>
</header>

<script>
  const openBtn = document.getElementById("openMobileNav");
  const closeBtn = document.getElementById("closeMobileNav");
  const panel = document.getElementById("mobileNav");

  const open = () => {
    if (!panel) return;
    panel.classList.remove("hidden");
    openBtn?.setAttribute("aria-expanded", "true");
    // prevent background scroll when menu is open
    document.documentElement.style.overflow = "hidden";
  };

  const close = () => {
    if (!panel) return;
    panel.classList.add("hidden");
    openBtn?.setAttribute("aria-expanded", "false");
    document.documentElement.style.overflow = "";
  };

  openBtn?.addEventListener("click", open);
  closeBtn?.addEventListener("click", close);

  // Close on Escape
  document.addEventListener("keydown", (e) => {
    if (e.key === "Escape") close();
  });
</script>
